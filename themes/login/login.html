<!doctype html>
<html>
<head>
<title>Ava is reading...</title>
{template ../c_link.html}
</head>

<body>
{template ../c_header.html}
<div class="main_form">
    <h1>登陆网站</h1>
	<div class="related"><a href="{$WEB_ROOT}login.php?act=toRegister&back={$back}">快速注册</a><a href="{$WEB_ROOT}login.php?act=toFindPwd&back={$back}">找回密码</a></div>
	<form id="loginForm" onSubmit="return submitForm()">
		<input type="hidden" name="act" value="login">
		<table class="tbl">
			<tr>
				<th width="80">用户名：<span class="required">*</span></th>
				<td width="280"><input type="text" class="text" name="name" onblur="verifyName()"></td>
				<td><span id="nameTip" class="tip">由3-10位英文字母或数字组成</span></td>
			</tr>
			<tr>
				<th>密码：<span class="required">*</span></th>
				<td><input type="password" class="text" name="pwd" maxLength="16" onblur="verifyPwd()"></td>
				<td><span id="pwdTip" class="tip">由6-16位下划线、英文字母或数字组成</span></td>
			</tr>
			<tr>
				<td class="btnTd" colspan="3"><input class="btn1" type="submit" value="登  陆"><a href="javascript:history.go(-1)" class="btn3">返&nbsp;&nbsp;回</a><span id="submitTip" class="tip"></span></td>
			</tr>
		</table>
	</form>
</div>
{template ../c_footer.html}
<script src="{$JS_PATH}user.js"></script>
<script>
function submitForm() {
	if(verifyName() && verifyPwd()) {
		var options = {
			type: 'POST',
			url: '{$WEB_ROOT}login.php?back={$back}',
			dataType: 'json',
			beforeSubmit: function() {
				$('#submitTip').html(loading);
				$('input[type="submit"]').attr('disabled', true);
			},
			success: function(r) {
				$('#submitTip').removeClass('error').removeClass('suc').html('');
				if(r.code == 0) {
					$('#submitTip').addClass('suc').html('登陆成功');
					location.href = r.back;
				} else if(r.code == 1) {
					$('#nameTip').addClass('error').html('该用户不存在');
				} else {
					$('#pwdTip').addClass('error').html('密码错误');
				}
				$('input[type="submit"]').attr('disabled', false);
				$(':input').focus(function() {
					$('#submitTip').removeClass('error').removeClass('suc').html('');
				});
			}
		};
		$('#loginForm').ajaxSubmit(options);
	}	
	return false;
}
</script>
</body>
</html>
